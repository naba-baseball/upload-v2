{"id":"upload-029","title":"Write Cloudflare admin setup guide","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:52.701652-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:30.797378-07:00","dependencies":[{"issue_id":"upload-029","depends_on_id":"upload-w81","type":"blocks","created_at":"2026-01-02T11:29:24.640114-07:00","created_by":"kaleb"}],"deleted_at":"2026-01-02T14:34:30.797378-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-3k7","title":"Fix tar extraction for Windows-encoded filenames (CP-1252)","description":"## Problem\nWhen extracting .tar.gz files created on Windows, files with non-ASCII characters in their names fail with 'Illegal byte sequence' errors.\n\nExample: `córdoba_archers.png` fails because Windows uses CP-1252 encoding, not UTF-8.\n\n## Root Cause\n- Windows tar creates archives with CP-1252 encoded filenames\n- macOS APFS filesystem **requires** valid UTF-8 filenames\n- Even with `LC_ALL=C`, APFS rejects the raw bytes\n\n## Findings\n- `:erl_tar` fails with `{:error, {:bad_header, :invalid_string}}`\n- System tar with UTF-8 locale doesn't help (encoding mismatch)\n- System tar with `LANG=C` doesn't help (APFS rejects non-UTF-8)\n- **Linux containers work** - extraction succeeds in Alpine container\n\n## Potential Solutions\n1. **Container-based extraction**: Run tar inside podman/docker, convert filenames with `convmv` from CP-1252 to UTF-8\n2. **Python tarfile**: Has explicit encoding parameter, can extract with `encoding='cp1252'`\n3. **Custom tar parser**: Decompress with `:zlib`, parse tar headers manually with encoding conversion\n\n## Current Workaround\nNone - affected uploads will fail.\n\n## Files\n- `lib/upload/deployer/cloudflare.ex:62-78` - extract_tarball/1 function","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T17:08:51.800834-07:00","created_by":"kaleb","updated_at":"2026-01-02T21:16:20.679874-07:00","closed_at":"2026-01-02T21:16:20.679874-07:00","close_reason":"Duplicate of upload-uy3 which has the correct solution approach (pure Elixir tar parser with Latin-1 to UTF-8 conversion)"}
{"id":"upload-3ux","title":"Document current state and design decisions","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:51.696127-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:13.877609-07:00","deleted_at":"2026-01-02T14:34:13.877609-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-4i4","title":"Resolve open questions for Cloudflare deployment","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:51.940613-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:21.978692-07:00","deleted_at":"2026-01-02T14:34:21.978692-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-55q","title":"Remove default Phoenix branding","description":"There are some leftover things from our phoenix starter, such as the phoenix logo. We don't need to show the phoenix logo.\n\nAfter this, no default phoenix UI should be around if its not necessary to our project","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-03T23:28:18.598736-07:00","created_by":"kaleb","updated_at":"2026-01-03T23:28:18.598736-07:00"}
{"id":"upload-79s","title":"Auth state is not persistent across browser sessions.","description":"After signing in with discord and closing and then re-opening the browser the user has to sign in again.\n\nWe'd like users to be able to sign in only once per device and never have to sign in again.","status":"open","priority":1,"issue_type":"bug","created_at":"2026-01-03T23:22:28.536744-07:00","created_by":"kaleb","updated_at":"2026-01-03T23:22:28.536744-07:00"}
{"id":"upload-a85","title":"Current State","description":"- Files upload as `.tar.gz` to `/tmp/{subdomain}_{uuid}.tar.gz`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.97875-07:00","updated_at":"2026-01-02T11:18:36.173822-07:00","closed_at":"2026-01-02T11:18:36.173822-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-c5y","title":"Write executive summary for Cloudflare deployment","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:52.966355-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:28.139796-07:00","dependencies":[{"issue_id":"upload-c5y","depends_on_id":"upload-w81","type":"blocks","created_at":"2026-01-02T11:29:24.850837-07:00","created_by":"kaleb"},{"issue_id":"upload-c5y","depends_on_id":"upload-drw","type":"blocks","created_at":"2026-01-02T11:29:24.932357-07:00","created_by":"kaleb"},{"issue_id":"upload-c5y","depends_on_id":"upload-029","type":"blocks","created_at":"2026-01-02T11:29:25.010218-07:00","created_by":"kaleb"}],"deleted_at":"2026-01-02T14:34:28.139796-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-drw","title":"Document security considerations and risk mitigation","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:52.441214-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:24.845536-07:00","dependencies":[{"issue_id":"upload-drw","depends_on_id":"upload-3ux","type":"blocks","created_at":"2026-01-02T11:29:24.43221-07:00","created_by":"kaleb"}],"deleted_at":"2026-01-02T14:34:24.845536-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-edp","title":"Security Considerations","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.980953-07:00","updated_at":"2026-01-02T11:18:36.181684-07:00","closed_at":"2026-01-02T11:18:36.181684-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-in1","title":"Improve Oban workflow error handling and UI updates","description":"The UI does not get updated if Oban workflows fail due to missing environment variables. This is likely true for other errors as well.\n\nAffected areas:\n- File upload workflows\n- Deployment processing\n- Webhook notifications\n\nRoot cause appears to be insufficient error handling that prevents the UI from being notified of workflow failures.\n\nRequired work:\n1. Identify all points where workflow errors can occur\n2. Ensure errors are properly logged with structured data\n3. Update UI state appropriately when workflows fail\n4. Add error notifications for users when applicable","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-02T17:18:12.605895-07:00","created_by":"kaleb","updated_at":"2026-01-03T23:30:07.35502-07:00","closed_at":"2026-01-03T23:30:07.355023-07:00"}
{"id":"upload-jlu","title":"Risk Mitigation","description":"| Risk | Mitigation |","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.981332-07:00","updated_at":"2026-01-02T11:18:36.183135-07:00","closed_at":"2026-01-02T11:18:36.183135-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-kfi","title":"Open Questions","description":"1. **404 handling**: Should unknown paths return a 404 page or redirect to index.html (SPA mode)?","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.981725-07:00","updated_at":"2026-01-02T11:18:36.184572-07:00","closed_at":"2026-01-02T11:18:36.184572-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-kpe","title":"File Structure","description":"```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.980587-07:00","updated_at":"2026-01-02T11:18:36.180255-07:00","closed_at":"2026-01-02T11:18:36.180255-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-lax","title":"Cloudflare Setup Instructions (for Admin)","description":"Since some setup requires Cloudflare dashboard access, document these steps:","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.980183-07:00","updated_at":"2026-01-02T11:18:36.17884-07:00","closed_at":"2026-01-02T11:18:36.17884-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-m84","title":"Implementation Plan","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.97977-07:00","updated_at":"2026-01-02T11:18:36.177257-07:00","closed_at":"2026-01-02T11:18:36.177257-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-mb5","title":"Key Design Decisions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.979364-07:00","updated_at":"2026-01-02T11:18:36.175477-07:00","closed_at":"2026-01-02T11:18:36.175477-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-uwd","title":"References","description":"- [Cloudflare Workers Static Assets](https://developers.cloudflare.com/workers/static-assets/)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.982133-07:00","updated_at":"2026-01-02T11:18:36.186384-07:00","closed_at":"2026-01-02T11:18:36.186384-07:00","close_reason":"Consolidating into dependent task structure"}
{"id":"upload-uy3","title":"Handle Latin-1 encoded filenames during tar extraction","description":"## Problem\n\nThe current tar extraction logic in `lib/upload/deployer/cloudflare.ex` uses `System.cmd(\"tar\", ...)` with UTF-8 locale settings, but tar archives may contain Latin-1 encoded filenames (e.g., `córdoba_archers.png` with byte `0xF3` instead of UTF-8 `0xC3 0xB3`).\n\n### Current behavior\n- **macOS**: Extraction fails with `EILSEQ` (illegal byte sequence) since APFS requires UTF-8\n- **Linux**: Files extract with raw Latin-1 bytes, causing URL routing mismatches\n- **Manifest**: Invalid UTF-8 strings in JSON keys\n\n### Root cause\n`erl_tar` fails with `{:bad_header, :invalid_string}` on these files. The system `tar` command extracts them but doesn't convert encoding.\n\n## Solution\n\nReplace `System.cmd(\"tar\", ...)` with a pure Elixir tar extractor that:\n1. Manually parses tar headers (512-byte blocks)\n2. Detects non-UTF-8 filenames using `String.valid?/1`\n3. Converts Latin-1 bytes to UTF-8 via `:binary.bin_to_list/1` -\u003e `List.to_string/1`\n\n### Implementation location\n`lib/upload/deployer/cloudflare.ex:62-81` (`extract_tarball/1` function)\n\n### Test case\nUse a tar.gz containing filenames with Latin-1 characters (e.g., `córdoba`, `café`, `naïve`).","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-02T20:56:32.137931-07:00","created_by":"kaleb","updated_at":"2026-01-02T20:56:32.137931-07:00"}
{"id":"upload-w81","title":"Create implementation plan with file structure","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T11:28:52.182722-07:00","created_by":"kaleb","updated_at":"2026-01-02T14:34:33.8876-07:00","dependencies":[{"issue_id":"upload-w81","depends_on_id":"upload-3ux","type":"blocks","created_at":"2026-01-02T11:29:24.143776-07:00","created_by":"kaleb"},{"issue_id":"upload-w81","depends_on_id":"upload-4i4","type":"blocks","created_at":"2026-01-02T11:29:24.224718-07:00","created_by":"kaleb"}],"deleted_at":"2026-01-02T14:34:33.8876-07:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"upload-zzj","title":"Executive Summary","description":"Deploy uploaded static assets to Cloudflare Workers using Worker Static Assets. Each site gets its own Worker, with the subdomain configured as a Custom Domain. The Worker is minimal - it just serves static assets with no custom logic.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T11:02:21.976033-07:00","updated_at":"2026-01-02T11:18:36.171075-07:00","closed_at":"2026-01-02T11:18:36.171075-07:00","close_reason":"Consolidating into dependent task structure"}
